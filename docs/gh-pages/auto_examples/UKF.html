<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Unscented Kalman Filter Example &mdash; StatOD  documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Square Root Information Filter Example" href="SRIF.html" />
    <link rel="prev" title="Kalman Filter with Stochastic Noise Compensation Example" href="CKF_SNC.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> StatOD
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">StatOD Examples Gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="PF.html">Particle Filter Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="CKF_SNC.html">Kalman Filter with Stochastic Noise Compensation Example</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Unscented Kalman Filter Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="SRIF.html">Square Root Information Filter Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="Smoother.html">Kalman Filter with Smoother Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="CKF_DMC.html">Kalman Filter with Dynamic Model Compensation Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="CCF.html">Consider Covariance Filter Example</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">StatOD</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">StatOD Examples Gallery</a> &raquo;</li>
      <li>Unscented Kalman Filter Example</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/auto_examples/UKF.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-ukf-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="unscented-kalman-filter-example">
<span id="sphx-glr-auto-examples-ukf-py"></span><h1>Unscented Kalman Filter Example<a class="headerlink" href="#unscented-kalman-filter-example" title="Permalink to this headline">ÔÉÅ</a></h1>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_UKF_001.png" srcset="../_images/sphx_glr_UKF_001.png" alt="UKF" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_UKF_002.png" srcset="../_images/sphx_glr_UKF_002.png" alt="UKF" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_UKF_003.png" srcset="../_images/sphx_glr_UKF_003.png" alt="UKF" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_UKF_004.png" srcset="../_images/sphx_glr_UKF_004.png" alt="UKF" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_UKF_005.png" srcset="../_images/sphx_glr_UKF_005.png" alt="UKF" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_UKF_006.png" srcset="../_images/sphx_glr_UKF_006.png" alt="UKF" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_UKF_007.png" srcset="../_images/sphx_glr_UKF_007.png" alt="UKF" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_UKF_008.png" srcset="../_images/sphx_glr_UKF_008.png" alt="UKF" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Progress:   0%|          | 0/2862 [00:00&lt;?, ?it/s]
Progress:   0%|          | 0/2862 [00:00&lt;?, ?it/s]
Progress:   1%|          | 25/2862 [00:00&lt;00:11, 244.61it/s]
Progress:   2%|1         | 50/2862 [00:00&lt;00:11, 246.43it/s]
Progress:   3%|2         | 75/2862 [00:01&lt;00:11, 247.44it/s]
Progress:   3%|3         | 100/2862 [00:01&lt;00:11, 246.70it/s]
Progress:   4%|4         | 125/2862 [00:01&lt;00:11, 244.46it/s]
Progress:   5%|5         | 150/2862 [00:01&lt;00:11, 243.54it/s]
Progress:   6%|6         | 176/2862 [00:01&lt;00:10, 248.64it/s]
Progress:   7%|7         | 208/2862 [00:01&lt;00:09, 268.71it/s]
Progress:   8%|8         | 240/2862 [00:01&lt;00:09, 282.55it/s]
Progress:   9%|9         | 271/2862 [00:01&lt;00:08, 289.63it/s]
Progress:  11%|#         | 303/2862 [00:01&lt;00:08, 296.57it/s]
Progress:  12%|#1        | 334/2862 [00:02&lt;00:08, 298.89it/s]
Progress:  13%|#2        | 365/2862 [00:02&lt;00:08, 301.86it/s]
Progress:  14%|#3        | 396/2862 [00:02&lt;00:08, 295.40it/s]
Progress:  15%|#4        | 426/2862 [00:02&lt;00:09, 267.83it/s]
Progress:  16%|#5        | 454/2862 [00:02&lt;00:09, 257.36it/s]
Progress:  17%|#6        | 481/2862 [00:02&lt;00:09, 256.30it/s]
Progress:  18%|#7        | 507/2862 [00:02&lt;00:09, 256.21it/s]
Progress:  19%|#8        | 533/2862 [00:02&lt;00:09, 252.76it/s]
Progress:  20%|#9        | 559/2862 [00:02&lt;00:09, 253.94it/s]
Progress:  20%|##        | 585/2862 [00:03&lt;00:09, 252.40it/s]
Progress:  21%|##1       | 611/2862 [00:03&lt;00:08, 253.31it/s]
Progress:  22%|##2       | 637/2862 [00:03&lt;00:08, 255.04it/s]
Progress:  23%|##3       | 665/2862 [00:03&lt;00:08, 261.84it/s]
Progress:  24%|##4       | 696/2862 [00:03&lt;00:07, 274.20it/s]
Progress:  25%|##5       | 727/2862 [00:03&lt;00:07, 282.66it/s]
Progress:  26%|##6       | 758/2862 [00:03&lt;00:07, 289.32it/s]
Progress:  28%|##7       | 789/2862 [00:03&lt;00:07, 293.68it/s]
Progress:  29%|##8       | 820/2862 [00:03&lt;00:06, 296.32it/s]
Progress:  30%|##9       | 851/2862 [00:03&lt;00:06, 297.50it/s]
Progress:  31%|###       | 881/2862 [00:04&lt;00:06, 293.71it/s]
Progress:  32%|###1      | 911/2862 [00:04&lt;00:06, 287.47it/s]
Progress:  33%|###2      | 940/2862 [00:04&lt;00:06, 282.30it/s]
Progress:  34%|###3      | 970/2862 [00:04&lt;00:06, 286.49it/s]
Progress:  35%|###4      | 1000/2862 [00:04&lt;00:06, 288.79it/s]
Progress:  36%|###5      | 1029/2862 [00:04&lt;00:06, 274.11it/s]
Progress:  37%|###6      | 1057/2862 [00:04&lt;00:06, 266.78it/s]
Progress:  38%|###7      | 1084/2862 [00:04&lt;00:06, 259.22it/s]
Progress:  39%|###8      | 1111/2862 [00:04&lt;00:06, 255.41it/s]
Progress:  40%|###9      | 1137/2862 [00:05&lt;00:07, 245.97it/s]
Progress:  41%|####      | 1162/2862 [00:05&lt;00:07, 233.42it/s]
Progress:  41%|####1     | 1187/2862 [00:05&lt;00:07, 236.04it/s]
Progress:  42%|####2     | 1214/2862 [00:05&lt;00:06, 242.91it/s]
Progress:  43%|####3     | 1240/2862 [00:05&lt;00:06, 245.95it/s]
Progress:  44%|####4     | 1270/2862 [00:05&lt;00:06, 260.86it/s]
Progress:  45%|####5     | 1301/2862 [00:05&lt;00:05, 274.40it/s]
Progress:  47%|####6     | 1333/2862 [00:05&lt;00:05, 285.37it/s]
Progress:  48%|####7     | 1362/2862 [00:05&lt;00:05, 285.72it/s]
Progress:  49%|####8     | 1391/2862 [00:05&lt;00:05, 282.57it/s]
Progress:  50%|####9     | 1420/2862 [00:06&lt;00:05, 282.51it/s]
Progress:  51%|#####     | 1449/2862 [00:06&lt;00:05, 281.15it/s]
Progress:  52%|#####1    | 1478/2862 [00:06&lt;00:04, 282.75it/s]
Progress:  53%|#####2    | 1507/2862 [00:06&lt;00:04, 271.79it/s]
Progress:  54%|#####3    | 1535/2862 [00:06&lt;00:05, 263.36it/s]
Progress:  55%|#####4    | 1562/2862 [00:06&lt;00:05, 259.66it/s]
Progress:  56%|#####5    | 1589/2862 [00:06&lt;00:04, 259.91it/s]
Progress:  56%|#####6    | 1616/2862 [00:06&lt;00:04, 253.51it/s]
Progress:  57%|#####7    | 1642/2862 [00:06&lt;00:04, 252.68it/s]
Progress:  58%|#####8    | 1668/2862 [00:07&lt;00:04, 242.93it/s]
Progress:  59%|#####9    | 1693/2862 [00:07&lt;00:04, 244.26it/s]
Progress:  60%|######    | 1718/2862 [00:07&lt;00:04, 245.35it/s]
Progress:  61%|######1   | 1747/2862 [00:07&lt;00:04, 256.59it/s]
Progress:  62%|######2   | 1778/2862 [00:07&lt;00:04, 270.05it/s]
Progress:  63%|######3   | 1809/2862 [00:07&lt;00:03, 279.38it/s]
Progress:  64%|######4   | 1839/2862 [00:07&lt;00:03, 282.86it/s]
Progress:  65%|######5   | 1868/2862 [00:07&lt;00:03, 282.47it/s]
Progress:  66%|######6   | 1897/2862 [00:07&lt;00:03, 262.51it/s]
Progress:  67%|######7   | 1924/2862 [00:08&lt;00:03, 251.10it/s]
Progress:  68%|######8   | 1950/2862 [00:08&lt;00:03, 247.27it/s]
Progress:  69%|######9   | 1976/2862 [00:08&lt;00:03, 249.12it/s]
Progress:  70%|######9   | 2002/2862 [00:08&lt;00:03, 250.04it/s]
Progress:  71%|#######   | 2028/2862 [00:08&lt;00:03, 251.30it/s]
Progress:  72%|#######1  | 2054/2862 [00:08&lt;00:03, 252.59it/s]
Progress:  73%|#######2  | 2082/2862 [00:08&lt;00:03, 259.69it/s]
Progress:  74%|#######3  | 2109/2862 [00:08&lt;00:02, 257.97it/s]
Progress:  75%|#######4  | 2135/2862 [00:08&lt;00:02, 255.30it/s]
Progress:  76%|#######5  | 2161/2862 [00:08&lt;00:02, 244.69it/s]
Progress:  76%|#######6  | 2187/2862 [00:09&lt;00:02, 246.64it/s]
Progress:  77%|#######7  | 2212/2862 [00:09&lt;00:02, 244.83it/s]
Progress:  78%|#######8  | 2238/2862 [00:09&lt;00:02, 246.71it/s]
Progress:  79%|#######9  | 2264/2862 [00:09&lt;00:02, 248.20it/s]
Progress:  80%|########  | 2290/2862 [00:09&lt;00:02, 249.93it/s]
Progress:  81%|########  | 2316/2862 [00:09&lt;00:02, 250.67it/s]
Progress:  82%|########1 | 2343/2862 [00:09&lt;00:02, 255.86it/s]
Progress:  83%|########2 | 2373/2862 [00:09&lt;00:01, 268.33it/s]
Progress:  84%|########3 | 2402/2862 [00:09&lt;00:01, 273.90it/s]
Progress:  85%|########4 | 2430/2862 [00:09&lt;00:01, 273.92it/s]
Progress:  86%|########5 | 2461/2862 [00:10&lt;00:01, 283.62it/s]
Progress:  87%|########7 | 2492/2862 [00:10&lt;00:01, 290.56it/s]
Progress:  88%|########8 | 2524/2862 [00:10&lt;00:01, 297.25it/s]
Progress:  89%|########9 | 2555/2862 [00:10&lt;00:01, 298.46it/s]
Progress:  90%|######### | 2585/2862 [00:10&lt;00:00, 293.14it/s]
Progress:  91%|#########1| 2615/2862 [00:10&lt;00:00, 279.80it/s]
Progress:  92%|#########2| 2644/2862 [00:10&lt;00:00, 267.77it/s]
Progress:  93%|#########3| 2671/2862 [00:10&lt;00:00, 257.60it/s]
Progress:  94%|#########4| 2697/2862 [00:10&lt;00:00, 254.04it/s]
Progress:  95%|#########5| 2723/2862 [00:11&lt;00:00, 250.46it/s]
Progress:  96%|#########6| 2749/2862 [00:11&lt;00:00, 243.68it/s]
Progress:  97%|#########6| 2774/2862 [00:11&lt;00:00, 235.71it/s]
Progress:  98%|#########7| 2799/2862 [00:11&lt;00:00, 237.82it/s]
Progress:  99%|#########8| 2825/2862 [00:11&lt;00:00, 242.13it/s]
Progress: 100%|#########9| 2856/2862 [00:11&lt;00:00, 259.79it/s]
Progress: 100%|##########| 2862/2862 [00:11&lt;00:00, 246.42it/s]
Time Elapsed: 11.616323232650757
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="kn">import</span> <span class="nn">time</span>
 <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
 <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
 <span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
 <span class="kn">import</span> <span class="nn">StatOD</span>
 <span class="kn">from</span> <span class="nn">StatOD.data</span> <span class="kn">import</span> <span class="n">get_measurements</span>
 <span class="kn">from</span> <span class="nn">StatOD.dynamics</span> <span class="kn">import</span> <span class="o">*</span>
 <span class="kn">from</span> <span class="nn">StatOD.filters</span> <span class="kn">import</span> <span class="o">*</span>
 <span class="kn">from</span> <span class="nn">StatOD.measurements</span> <span class="kn">import</span> <span class="o">*</span>
 <span class="kn">from</span> <span class="nn">StatOD.visualizations</span> <span class="kn">import</span> <span class="o">*</span>
 <span class="kn">from</span> <span class="nn">StatOD.constants</span> <span class="kn">import</span> <span class="o">*</span>

 <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>

     <span class="n">ep</span> <span class="o">=</span> <span class="n">EarthParams</span><span class="p">()</span>
     <span class="n">cart_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">3515.4903270335103</span><span class="p">,</span> <span class="mf">8390.716310243395</span><span class="p">,</span> <span class="mf">4127.627352553683</span><span class="p">,</span>
                            <span class="o">-</span><span class="mf">4.357676322178153</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.3565791387645487</span><span class="p">,</span> <span class="mf">3.111892927869902</span><span class="p">])</span>

     <span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">X_stations_ECI</span> <span class="o">=</span> <span class="n">get_measurements</span><span class="p">(</span><span class="s2">&quot;Data/Measurements/range_rangerate_w_J2_w_noise.data&quot;</span><span class="p">)</span>

     <span class="c1"># Decrease scenario length</span>
     <span class="n">M_end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">//</span> <span class="mi">5</span>
     <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[:</span><span class="n">M_end</span><span class="p">]</span>
     <span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[:</span><span class="n">M_end</span><span class="p">]</span>

     <span class="c1"># Initialize state and filter parameters</span>
     <span class="n">dx0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1E-4</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
     <span class="n">x0</span> <span class="o">=</span> <span class="n">cart_state</span> <span class="o">+</span> <span class="n">dx0</span>

     <span class="n">P_diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1E-3</span><span class="p">,</span> <span class="mf">1E-3</span><span class="p">,</span> <span class="mf">1E-3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
     <span class="n">R_diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1E-3</span><span class="p">,</span> <span class="mf">1E-6</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
     <span class="n">P0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">P_diag</span><span class="p">)</span>
     <span class="n">R0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">R_diag</span><span class="p">)</span>
     <span class="n">t0</span> <span class="o">=</span> <span class="mf">0.0</span>

     <span class="c1"># Initialize Process Noise</span>
     <span class="n">Q0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">5e-8</span> <span class="o">**</span> <span class="mi">2</span>
     <span class="n">Q_args</span> <span class="o">=</span> <span class="p">[]</span>
     <span class="n">Q_fcn</span> <span class="o">=</span> <span class="n">process_noise</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">Q0</span><span class="p">,</span> <span class="n">get_Q</span><span class="p">,</span> <span class="n">Q_args</span><span class="p">,</span> <span class="n">use_numba</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

     <span class="c1"># Initialize Dynamics and Measurements</span>
     <span class="n">f_args</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ep</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="n">ep</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="n">ep</span><span class="o">.</span><span class="n">J2</span><span class="p">])</span>
     <span class="n">f</span><span class="p">,</span> <span class="n">dfdx</span> <span class="o">=</span> <span class="n">dynamics</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">f_J2</span><span class="p">,</span> <span class="n">f_args</span><span class="p">)</span>
     <span class="n">f_dict</span> <span class="o">=</span> <span class="p">{</span>
         <span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="n">f</span><span class="p">,</span>
         <span class="s2">&quot;dfdx&quot;</span><span class="p">:</span> <span class="n">dfdx</span><span class="p">,</span>
         <span class="s2">&quot;f_args&quot;</span><span class="p">:</span> <span class="n">f_args</span><span class="p">,</span>
         <span class="s2">&quot;Q_fcn&quot;</span><span class="p">:</span> <span class="n">Q_fcn</span><span class="p">,</span>
         <span class="s2">&quot;Q&quot;</span><span class="p">:</span> <span class="n">Q0</span><span class="p">,</span>
         <span class="s2">&quot;Q_args&quot;</span><span class="p">:</span> <span class="n">Q_args</span><span class="p">,</span>
     <span class="p">}</span>

     <span class="n">h_args</span> <span class="o">=</span> <span class="n">X_stations_ECI</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
     <span class="n">h</span><span class="p">,</span> <span class="n">dhdx</span> <span class="o">=</span> <span class="n">measurements</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">h_rho_rhod</span><span class="p">,</span> <span class="n">h_args</span><span class="p">)</span>
     <span class="n">h_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="n">h</span><span class="p">,</span> <span class="s1">&#39;dhdx&#39;</span><span class="p">:</span> <span class="n">dhdx</span><span class="p">,</span> <span class="s1">&#39;h_args&#39;</span><span class="p">:</span> <span class="n">h_args</span><span class="p">}</span>

     <span class="c1">#########################</span>
     <span class="c1"># Generate f/h_args_vec #</span>
     <span class="c1">#########################</span>

     <span class="n">f_args_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">f_args</span><span class="p">)),</span> <span class="n">f_args</span><span class="p">)</span>
     <span class="n">h_args_vec</span> <span class="o">=</span> <span class="n">X_stations_ECI</span>
     <span class="n">R_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">R0</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

     <span class="c1">##############</span>
     <span class="c1"># Run Filter #</span>
     <span class="c1">##############</span>

     <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1E-3</span>
     <span class="n">beta</span> <span class="o">=</span> <span class="mf">2.0</span>
     <span class="n">kappa</span> <span class="o">=</span> <span class="mf">0.0</span>

     <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
     <span class="n">logger</span> <span class="o">=</span> <span class="n">FilterLogger</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
     <span class="nb">filter</span> <span class="o">=</span> <span class="n">UnscentedKalmanFilter</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">dx0</span><span class="p">,</span> <span class="n">P0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">f_dict</span><span class="p">,</span> <span class="n">h_dict</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
     <span class="nb">filter</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:],</span> <span class="n">R_vec</span><span class="p">,</span> <span class="n">f_args_vec</span><span class="p">,</span> <span class="n">h_args_vec</span><span class="p">)</span>
     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time Elapsed: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">))</span>

     <span class="c1">##################################</span>
     <span class="c1"># Gather measurement predictions #</span>
     <span class="c1">##################################</span>
     <span class="n">package_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">StatOD</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/../&quot;</span>
     <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">package_dir</span> <span class="o">+</span> <span class="s1">&#39;Data/Trajectories/trajectory_J2.data&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
         <span class="n">traj_data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

     <span class="n">x_truth</span> <span class="o">=</span> <span class="n">traj_data</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">][:</span><span class="n">M_end</span><span class="p">]</span>
     <span class="n">y_hat_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
         <span class="n">y_hat_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">filter</span><span class="o">.</span><span class="n">predict_measurement</span><span class="p">(</span><span class="n">logger</span><span class="o">.</span><span class="n">x_hat_i_plus</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">h_args_vec</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

     <span class="n">directory</span> <span class="o">=</span> <span class="s2">&quot;Plots/&quot;</span> <span class="o">+</span> <span class="nb">filter</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
     <span class="n">y_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;$\rho$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\dot{\rho}$&#39;</span><span class="p">])</span>
     <span class="n">vis</span> <span class="o">=</span> <span class="n">VisualizationBase</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
     <span class="n">vis</span><span class="o">.</span><span class="n">plot_state_errors</span><span class="p">(</span><span class="n">x_truth</span><span class="p">)</span>
     <span class="n">vis</span><span class="o">.</span><span class="n">plot_residuals</span><span class="p">(</span><span class="n">Y</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:],</span> <span class="n">y_hat_vec</span><span class="p">,</span> <span class="n">R_vec</span><span class="p">,</span> <span class="n">y_labels</span><span class="p">)</span>
     <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


 <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
     <span class="n">main</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  16.404 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-ukf-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/0f15a1fbb02aea8f7eb779e35d841545/UKF.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">UKF.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/014ec81186aefaac162721e36994e624/UKF.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">UKF.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="CKF_SNC.html" class="btn btn-neutral float-left" title="Kalman Filter with Stochastic Noise Compensation Example" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="SRIF.html" class="btn btn-neutral float-right" title="Square Root Information Filter Example" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, John M.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>